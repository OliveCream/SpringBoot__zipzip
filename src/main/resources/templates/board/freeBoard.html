<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
<div th:replace="/common/header :: header"></div>
<link rel="stylesheet" href="/resources/css/freeBoard.css" />
</head>

<body>
   <!-- ë„¤ë¹„ ì‹œì‘ -->
   <div th:replace="/common/nav :: nav"></div>
   <!-- ë„¤ë¹„ ë -->

   <!-- ë³¸ë¬¸ ì‹œì‘ -->
   <div style="height: 13vh;"></div>

   <div class="board-Page-container">
      <div class="board-container">
         <!-- ê²Œì‹œíŒ ì „ì²´ ë‚´ìš© div -->
         <div class="board-content-container">

            <!-- head(ê²€ìƒ‰ì°½ ë“±) -->
            <div class="board-head">
               <a class="board-head-name" href="/board/freeBoard">&#127795;ì»¤ë®¤ë‹ˆí‹°&#127795;</a>
               <div class="board-head-align">
                  <span class="board-head-align-new"
                     th:onclick="'fn_pageClick(' + ${curPage} + ',' + 2 + ')'">ì¸ê¸°ìˆœğŸ·</span>
                  <!--                   <span class="board-head-align-new" >ì¶”ì²œìˆœ</span> -->
                  <span class="board-head-align-new2"
                     th:onclick="'fn_pageClick(' + ${curPage} + ',' + 1 + ')'">ìµœì‹ ìˆœğŸ¤</span>
               </div>
               <div class="button-write-container">
                  <button id="btnWrite" class="button-write">ê¸€ì“°ê¸° ğŸ’­</button>
               </div>
            </div>

            <!-- í…Œì´ë¸” ë‚´ìš© -->
            <div class="table-content">
               <table>
                  <thead>
                     <tr>
                        <th style="width:60px;">ë²ˆí˜¸</th>
                        <th style="width:60px;">ê¸€ì“´ì´</th>
                        <th style="width:270px;">ì œëª©</th>
                        <th style="width:80px;">ë“±ë¡ì¼</th>
                        <th style="width:50px;">ì¶”ì²œ</th>
                        <th style="width:50px;">ì¡°íšŒ</th>
                     </tr>
                  </thead>
                  <tbody>
                     <tr th:if="${list != null}" th:each="list : ${list}">
                        <td th:text="${list.communityNum}" class="td-num">ê¸€ë²ˆí˜¸ê°’</td>
                        <td th:text="${list.userId} != null ? ${list.userId} : ${list.agentId}" class="td-text">ì‘ì„±ìê°’</td>
                        <td class="td-text-content" th:onclick="'fn_view(' + ${list.communityNum} + ')'" style="cursor:pointer;">
                            <span th:text="${list.communityTitle != null && #strings.length(list.communityTitle) >= 35 ? #strings.substring(list.communityTitle, 0, 35) + '...' : list.communityTitle}">ê¸€ì œëª©ê°’</span>
                            <span class="comment-cnt" th:if="${list.commentCnt > 0}" th:text="'(' + ${list.commentCnt} + ')'"></span>
                        </td>
                        <td th:text="${list.regDate}" class="td-num">ì‘ì„±ì¼ê°’</td>
                        <td th:text="${list.likeCnt}" class="td-num">ì¶”ì²œìˆ˜ê°’</td>
                        <td th:text="${list.readCnt}" class="td-num">ì¡°íšŒìˆ˜ê°’</td>
                     </tr>
                  </tbody>
               </table>
            </div>

            <!-- bottom -->
            <div class="board-bottom">
               <div class="board-input-container">
                  <select id="searchSelect" name="searchSelect" class="board-select">
                     <option value="all" th:selected="${searchType} == 'all'">í†µí•©ê²€ìƒ‰</option>
                     <option value="title" th:selected="${searchType} == 'title'">ì œëª©</option>
                     <option value="content" th:selected="${searchType} == 'content'">ë‚´ìš©</option>
                     <option value="author" th:selected="${searchType} == 'author'">ì‘ì„±ì</option>
                  </select>
                  <input id="searchInput" class="board-input" type="text" th:value="${searchValue}">
                  <button class="search-button" id="btnSearch">ê²€ìƒ‰ &#128269;</button>
               </div>

               <div class="board-paging-container">
                  <div class="page_wrap">
                     <div class="page_nation" th:if="${paging != null}">
                        <th:block th:if="${paging.prevBlockPage gt 0}">
                           <a class="" href="#" th:onclick="'fn_pageClick(' + 1 + ',' + ${sort} + ')'"><<</a>
                           <a class="" href="#" th:onclick="'fn_pageClick(' + ${paging.prevBlockPage} + ',' + ${sort} + ')'"><</a>
                        </th:block>
                        <th:block th:each="i: ${#numbers.sequence(paging.startPage, paging.endPage)}">
                           <a class="active" th:if="${i == paging.curPage}" th:text="${i}">1</a>
                           <a href="#" th:if="${i != paging.curPage}" th:text="${i}" th:onclick="'fn_pageClick(' + ${i} + ',' + ${sort} + ')'">2</a>
                        </th:block>
                        <th:block th:if="${paging.nextBlockPage gt 0}">
                           <a class="" href="#" th:onclick="'fn_pageClick(' + ${paging.nextBlockPage} + ',' + ${sort} + ')'">></a>
<!--                            <a class="" href="#" th:onclick="'fn_pageClick(' + ${paging.lastPage} + ',' + ${sort} + ')'">>></a> -->
                        </th:block>
                     </div>
                  </div>
                  <form id="searchForm" name="searchForm" method="post">
                     <input type="hidden" id="communityNum" name="communityNum" value="${communityNum}" />
                     <input type="hidden" id="curPage" name="curPage" th:value="${curPage}" />
                     <input type="hidden" id="searchType" name="searchType" th:value="${searchType}" />
                     <input type="hidden" id="searchValue" name="searchValue" th:value="${searchValue}" />
                     <input type="hidden" id="sort" name="sort" th:value="${sort}" />
                  </form>
               </div>
            </div>
         </div>

      </div>
   </div>
   <!-- ë³¸ë¬¸ ë -->

   <!-- í‘¸í„° ì‹œì‘ -->
   <footer th:replace="/common/footer :: footer"></footer>
   <!-- í‘¸í„° ë -->

   <!-- ê°œë³„ js -->
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
   <script type="text/javascript">
      $(document).ready(function () {

         $("#btnWrite").on("click", function () {
            
             if('[[${user}]]' == 'null' || '[[${user}]]' == ''){
                alert("ê¸€ì„ ì‘ì„±í•˜ë ¤ë©´ íšŒì› ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤. ");
                return;
             }

            document.searchForm.curPage.value = "1";
            document.searchForm.action = "/board/freeBoardWrite";
            document.searchForm.submit();

         }); btnSearch

         //ê²€ìƒ‰ë²„íŠ¼ í´ë¦­ì‹œ
         $("#btnSearch").on("click", function () {

            document.searchForm.searchType.value = $("#searchSelect").val();
            document.searchForm.searchValue.value = $("#searchInput").val();
            document.searchForm.curPage.value = "1";
            document.searchForm.action = "/board/freeBoard";
            document.searchForm.submit();

         })
      });
      
      function fn_pageClick(curPage, sort) {
         document.searchForm.curPage.value = curPage;
         document.searchForm.sort.value = sort;
         document.searchForm.action = "/board/freeBoard";
         document.searchForm.submit();
      }
      
      //ìƒì„¸í˜ì´ì§€
      function fn_view(communityNum) {
         document.searchForm.communityNum.value = communityNum;
         document.searchForm.action = "/board/freeBoardDetail?communityNum=" + communityNum;
         document.searchForm.submit();
      }
   </script>
</body>

</html>